#!/usr/bin/env python3
import sys
import requests
import re
from requests.exceptions import ConnectionError

def scrape(url):
    r = requests.get(url, verify=False)
    #TODO: revisar que si comen√ßa per ' pot matchejar " internament i tal."
    srcs_r = re.compile(r'src=["\'](.[^"\']*)["\']')
    href_r = re.compile(r'href=["\'](.[^"\']*)["\']')

    resources = []
    resources += re.findall(href_r, r.text)
    resources += re.findall(srcs_r, r.text)

    return sorted(set(resources))


if __name__ == "__main__":

    url_name = sys.argv[1]

    try:
        https_uris = scrape('https://'+url_name)
    except ConnectionError:
        https_uris = []

    try:
        http_uris = scrape('http://'+url_name)
    except ConnectionError:
        http_uris = []

    if http_uris == https_uris:
        print('URIs:')
        for uri in https_uris:
            print(uri)
    else:
        print('HTTPS URIs:')
        for uri in https_uris:
            print(uri)
        print('\nHTTP URIs:')
        for uri in http_uris:
            print(uri)


